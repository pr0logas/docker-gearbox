FROM alpine:3.3
MAINTAINER Gearbox Team <team@gearbox.works>

ARG GEARBOX_CONTAINER_NAME="gearbox-base"
ARG GEARBOX_CONTAINER_VERSION="alpine-3.3"
ARG GEARBOX_USER="gearbox"
ARG GEARBOX_UID="1000"
ARG GEARBOX_GROUP="gearbox"
ARG GEARBOX_GID="1000"
ARG GEARBOX_HTTP_PROXY="http://proxy:3128/"
ARG GEARBOX_HTTPS_PROXY="http://proxy:3128/"

ENV GEARBOX_BASE_VERSION $GEARBOX_CONTAINER_VERSION
ENV GEARBOX_CONTAINER_NAME $GEARBOX_CONTAINER_NAME
ENV GEARBOX_CONTAINER_VERSION $GEARBOX_CONTAINER_VERSION
ENV GEARBOX_USER $GEARBOX_USER
ENV GEARBOX_UID $GEARBOX_UID
ENV GEARBOX_GROUP $GEARBOX_GROUP
ENV GEARBOX_GID $GEARBOX_GID
ENV http_proxy $GEARBOX_HTTP_PROXY
ENV https_proxy $GEARBOX_HTTP_PROXY

COPY build /build
COPY gearbox.json /build/gearbox.json

RUN echo "GEARBOX_BASE_VERSION=$GEARBOX_CONTAINER_VERSION; export GEARBOX_BASE_VERSION" > /build/version-base.sh && /bin/sh /build/build-base.sh

WORKDIR /project
EXPOSE 9970
USER root

CMD	[ "/bin/bash", "-l" ]
